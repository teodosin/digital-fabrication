<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="./favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="./_app/immutable/assets/0.lmDuvr4l.css" rel="stylesheet">
		<link href="./_app/immutable/assets/3.ByynXfGf.css" rel="stylesheet">
		<link rel="modulepreload" href="./_app/immutable/entry/start.l-RPuAaQ.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/entry.BIBHztwZ.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/scheduler.WqRDolvd.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/paths.yp7QwO9p.js">
		<link rel="modulepreload" href="./_app/immutable/entry/app.uIMNZRZK.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/preload-helper.0HuHagjb.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/index.0NVKo1ab.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/0.7-tO0fzn.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/3.GKfNdeG1.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">   <nav class="nav svelte-1kc7d4u" data-svelte-h="svelte-1x1gium"><a class="nav-button svelte-1kc7d4u" href="./">Home</a></nav>     <img class="cover-banner svelte-1ov577t" src="frontpage_screenshot.png" style="transform: translate3d(0, 0px, 0);"> <div class="post-header  svelte-1ov577t"><h1>Project Management - This Site</h1> <p class="date svelte-1ov577t">Published: 2024-01-18</p></div> <div class="centered-container svelte-1ov577t"><div class="toc svelte-1ov577t"></div> <article class="post svelte-1ov577t"><p data-svelte-h="svelte-1vzouhn">Our first assignment in the Digital Fabrication minor was to build a portfolio site for out projects.</p> <p data-svelte-h="svelte-103b61o">I have a couple years of web development experience, mostly with React. And I am quite bored of it in so many ways. I had been eyeing Svelte for quite a while, and considered using it for my personal site or even a client project. This assignment was the perfect excuse to start learning it. I also had no previous experience building static websites or doing anything with Github Pages or with processing Markdown.</p> <p data-svelte-h="svelte-dgu6ig">So far? I love it.</p> <p data-svelte-h="svelte-m174ic">I am using Github Copilot to help with the coding. I have been using it half a year at this point for my other projects and quite like the increase in speed I’m getting. It has been saving me a lot of time I would have otherwise spent googling for documentation and looking at html and css references. I am by no means an expert web dev, but I know enough that I can fix the occasional ridiculous suggestions by copilot. So it has definitely been worth it.</p> <p data-svelte-h="svelte-mbimis">I am having a lot of fun just incrementally adding features to make it nice to write content for the site. It’s been so nice, in fact, that I’ve decided to make this my actual website eventually.</p> <p data-svelte-h="svelte-10mprd9">The <a href="https://github.com/teodosin/digital-fabrication" rel="nofollow">repository</a> is public, so you can take a look if you are interested.</p> <p data-svelte-h="svelte-151sr2r">As for how git is used: I try to make commits for each small change and push them directly to main. For larger changes and implementations I will make separate branches and merge them when they are ready. Not much more to it than that.</p> <h6 data-svelte-h="svelte-qsq8co">note: If the link is broken, that probably means I’ve renamed the repository and haven’t updated this post. It’s on my <a href="https://github.com/teodosin" rel="nofollow">profile</a> somewhere.</h6> <h4 data-svelte-h="svelte-159ws9e">Features of the site:</h4> <ul data-svelte-h="svelte-qxja7l"><li>Posts are written in markdown and automatically turned into pages on the site (See screenshot below)</li> <li>Posts can be filtered on the home page by their category tags in the markdown metadata</li> <li>Posts can have covers set for them right from the markdown file</li> <li>Images are automatically resized before deployment of the site</li> <li>Long-form posts automatically get a table of contents generated for them</li> <li>It’s a fun way for me to dip back into web dev and just play around</li></ul> <p data-svelte-h="svelte-kmiqae">For reference, this is what the raw markdown for this page looks like in my editor.
<img src="markdown_example.png" alt="A screenshot of this page's raw markdown"></p> <hr> <p data-svelte-h="svelte-rvupqx">Here’s something useful: automatic resizing of images when building the site.</p> <p data-svelte-h="svelte-1gqw8uh">I have a resize-images.js script that gets called before the site is built.</p> <pre class="language-json"><!-- HTML_TAG_START --><code class="language-json">    <span class="token comment">// package.json</span>
	<span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"node src/lib/utils/generate-entries.js &amp;&amp; vite dev"</span><span class="token punctuation">,</span>
		<span class="token property">"resize-images"</span><span class="token operator">:</span> <span class="token string">"node src/lib/utils/resize-images.js"</span><span class="token punctuation">,</span>
		<span class="token comment">// snip </span>
		<span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"npm run resize-images &amp;&amp; vite build"</span><span class="token punctuation">,</span>
        <span class="token comment">// snip</span>
		<span class="token property">"deploy"</span><span class="token operator">:</span> <span class="token string">"npm run build &amp;&amp; npx gh-pages -d build -t true"</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-13gb66i">I am currently deploying the site manually from the terminal when I choose to. I run the command <code>npm run deploy</code>, which in turn calls the <code>build</code> script. That, in turn runs the <code>resize-images</code> script before finally building the site. The next command always waits for the previous one to complete before starting, so it’s reliable.</p> <p data-svelte-h="svelte-1uyf5ap">Here’s the actual script in its entirety.</p> <pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token comment">// src/lib/utils/resize-images.js</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> readdir<span class="token punctuation">,</span> unlink<span class="token punctuation">,</span> rename <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> join <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> sharp <span class="token keyword">from</span> <span class="token string">'sharp'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> directoryPath <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> maxWidth <span class="token operator">=</span> <span class="token number">1080</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> maxHeight <span class="token operator">=</span> <span class="token number">1080</span><span class="token punctuation">;</span>

<span class="token function">readdir</span><span class="token punctuation">(</span>directoryPath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Unable to scan directory: '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> filePath <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>directoryPath<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> tempFilePath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>filePath<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">_temp</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>

    <span class="token function">sharp</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>maxWidth<span class="token punctuation">,</span> maxHeight<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">fit</span><span class="token operator">:</span> <span class="token string">'inside'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">withoutEnlargement</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span>tempFilePath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error resizing image: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
          <span class="token function">unlink</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error deleting original file: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
              <span class="token function">rename</span><span class="token punctuation">(</span>tempFilePath<span class="token punctuation">,</span> filePath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
<span class="token comment">//  Omitted error handling at the end. </span>
</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-qpa50">The script goes through each file in my static folder. For each image it creates a new, resized version of it, then replaces the old image with it. This was necessary to do in two steps because you can’t delete or overwrite the old file while you’re still resizing it.</p></article> </div> 
			
			<script>
				{
					__sveltekit_1ww7bg8 = {
						base: new URL(".", location).pathname.slice(0, -1),
						assets: "/digital-fabrication"
					};

					const element = document.currentScript.parentElement;

					const data = [{"type":"data","data":null,"uses":{}},{"type":"data","data":null,"uses":{}}];

					Promise.all([
						import("./_app/immutable/entry/start.l-RPuAaQ.js"),
						import("./_app/immutable/entry/app.uIMNZRZK.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
